<!-- Logo -->
<div class="container-logo">
    <a class="navbar-brand d-flex justify-content-center align-items-center sidebar-brand m-0" routerLink="/dashboard"
        routerLinkActive="active">
        <img class="logo" id="logo" src="/Imagenes/wknblack.png">
    </a>
</div>
<div class="reset-page">
    <div class="reset-container">
        <!-- Paso 1: Email -->
        <div *ngIf="step === 1" class="step">
            <div class="reset-header">
                <h2>Recuperar contraseña</h2>
                <p class="reset-subtitle">
                    Ingresa tu correo electrónico y te enviaremos un código de verificación
                </p>
            </div>

            <div class="form-group">
                <label for="email">Correo electrónico</label>
                <input id="email" type="email" [(ngModel)]="email" placeholder="Ingresa tu correo electrónico"
                    [class.loading]="loading" />
            </div>

            <div class="actions">
                <button (click)="irALogin()" class="btn-secondary" [disabled]="loading">
                    Cancelar
                </button>
                <button (click)="enviarCodigo()" [disabled]="loading || !email" class="btn-primary">
                    {{ loading ? 'Enviando...' : 'Enviar código' }}
                </button>
            </div>
        </div>

        <!-- Paso 2: Código y Nueva Contraseña -->
        <div *ngIf="step === 2" class="step">
            <div class="reset-header">
                <h2>Crear nueva contraseña</h2>
                <p class="reset-subtitle">
                    Ingresa el código que recibiste y tu nueva contraseña
                </p>
            </div>

            <div class="email-confirmation">
                <p>Código enviado a: <strong>{{email}}</strong></p>
            </div>
            <div class="form-group">
                <label for="codigo">Código de verificación</label>
                <input id="codigo" type="text" [(ngModel)]="codigo" placeholder="Ingresa el código de 6 dígitos"
                    [class.loading]="loading" required />
                <p class="expira-msg">Tu código expira en <strong>15 minutos</strong>.</p>
            </div>
            <div class="resend-box">
                <button [disabled]="resendDisabled" (click)="reenviarCodigo()" class="btn-resend">
                    Reenviar código
                </button>

                <p *ngIf="resendDisabled" class="timer">
                    Puedes reenviar en {{ resendTimer }}s
                </p>
            </div>

            <div class="form-group">
                <label for="password">Nueva contraseña</label>
                <div class="input-wrapper">
                    <input id="password" type="password" [(ngModel)]="password"
                        placeholder="Crea una nueva contraseña" />
                    <i class="fas fa-eye toggle-password" (click)="togglePasswordVisibility('password')"></i>
                </div>
            </div>

            <div class="form-group">
                <label for="confirmPassword">Confirmar contraseña</label>
                <div class="input-wrapper">
                    <input id="confirmPassword" type="password" [(ngModel)]="confirmPassword"
                        placeholder="Confirma tu nueva contraseña" />
                    <i class="fas fa-eye toggle-password" (click)="togglePasswordVisibility('confirmPassword')"></i>
                </div>
            </div>


            <div class="actions">
                <button (click)="volver()" class="btn-secondary" [disabled]="loading">
                    Volver
                </button>
                <button (click)="cambiarPassword()" [disabled]="loading || !codigo || !password || !confirmPassword"
                    class="btn-primary">
                    {{ loading ? 'Actualizando...' : 'Cambiar contraseña' }}
                </button>
            </div>
        </div>
    </div>
    <div class="curva">
        <div class="container-img"></div>
    </div>
</div>