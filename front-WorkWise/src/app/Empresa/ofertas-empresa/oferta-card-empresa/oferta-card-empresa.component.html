<div class="content-wrapper">
    <div style="flex: 1;">
        <div class="job-layout">
            <!-- ðŸŸ¦ LISTA IZQUIERDA -->
            <div class="job-list">
                <h3 class="section-title">Tus ofertas</h3>

                <div *ngIf="ofertas.length === 0" class="no-data">
                    <p>No tienes ofertas publicadas aÃºn.</p>
                </div>

                <div *ngIf="ofertas.length > 0">
                    <div *ngFor="let oferta of ofertas" class="card" (click)="seleccionarOferta(oferta)"
                        [class.selected]="ofertaSeleccionada?.id === oferta.id">
                        <div class="offer-content">
                            <h3>{{ oferta.titulo }}</h3>
                            <p class="company">{{ oferta.empresa.nombre }}</p>
                            <p class="location"><i class="fas fa-map-marker-alt" style="margin-right: 5px;"></i>{{
                                oferta.ubicacion }}</p>

                            <div class="tags">
                                <span class="salary">{{ oferta.salario.toLocaleString('es-CO') }}</span>
                                <span class="type">{{ getTipoEmpleo(oferta.tipo_Empleo) }}</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- ðŸŸ© PANEL DERECHO (DETALLES) -->
            <div class="job-details" *ngIf="ofertaSeleccionada">
                <div class="job-details-container">
                    <!-- Header Section -->
                    <div class="job-header">
                        <div class="menu-wrapper" (click)="toggleMenu()" tabindex="0">
                            <i class="fas fa-ellipsis-v menu-icon"></i>

                            <div class="menu-options" *ngIf="menuAbierto">
                                <button class="menu-item" (click)="editarOferta(ofertaSeleccionada)">
                                    <i class="fas fa-edit"></i> Editar
                                </button>
                                <button *ngIf="ofertaSeleccionada.activo" class="menu-item"
                                    (click)="cambiarEstadoOferta(ofertaSeleccionada)">
                                    <i class="fas fa-ban"></i> Deshabilitar oferta
                                </button>
                                <button *ngIf="!ofertaSeleccionada.activo" class="menu-item"
                                    (click)="cambiarEstadoOferta(ofertaSeleccionada)">
                                    <i class="fas fa-check-circle"></i> habilitar oferta
                                </button>
                            </div>
                        </div>
                        <h1 class="job-title">{{ ofertaSeleccionada.titulo }}</h1>
                        <div class="company-info">
                            <span class="company-name">{{ ofertaSeleccionada.empresa.nombre }}</span>
                        </div>
                    </div>

                    <div class="divider"></div>

                    <!-- Job Specifications -->
                    <div class="specifications-section">
                        <h2 class="section-title">InformaciÃ³n del empleo</h2>
                        <div class="spec-list">
                            <div class="spec-item">
                                <div class="spec-header">
                                    <i class="fas fa-wallet"></i><span class="spec-title">Sueldo</span>
                                </div>
                                <div class="preview-chip success">
                                    {{ ofertaSeleccionada.salario.toLocaleString('es-CO') }}<span
                                        class="checkmark">âœ”</span>
                                </div>
                            </div>

                            <div class="spec-item">
                                <div class="spec-header">
                                    <i class="fas fa-briefcase"></i><span class="spec-title">Tipo de empleo</span>
                                </div>
                                <div class="preview-chip-group">
                                    <div class="preview-chip neutral">{{ this.Tipo_empleo}}</div>
                                    <div class="preview-chip neutral">{{ this.tipo_Contrato }}</div>
                                    <div class="preview-chip neutral">{{ ofertaSeleccionada.modalidad }}</div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="divider"></div>

                    <!-- Location Section -->
                    <div class="location-section">
                        <div class="spec-header">
                            <i class="fas fa-map-marker-alt"></i><span class="spec-title">Location</span>
                        </div>
                        <div class="location-item">
                            <span class="location-detail">{{ ofertaSeleccionada.ubicacion }}</span>
                        </div>
                    </div>

                    <div class="divider"></div>

                    <!-- Full Job Description -->
                    <div class="description-section">
                        <h2 class="section-title">Full job description</h2>
                        <div class="job-description">
                            <p [innerHTML]="ofertaSeleccionada.descripcion"></p>
                        </div>

                    </div>
                    <h4>Aptitudes relacionadas con el empleo</h4>
                    <div style="margin-bottom: 20px;">
                        <div class="preview-chip neutral" *ngFor="let hab of ofertaSeleccionada?.habilidades">{{
                            hab.habilidad.nombre || 'sin competencias' }}</div>
                    </div>
                    <div class="Requerimientos">
                        <h3 class="subsection-title">Requisitos:</h3>
                        <ul>
                            <li>
                                <div class="modal-info-item" id="modal-experience">
                                    <strong>Experiencia:</strong>{{ this.experiencia}}
                                </div>
                            </li>
                            <li>
                                <div class="modal-info-item" id="modal-studyLevel"><strong>Nivel de
                                        estudio:</strong>{{this.nivel_Educacion}}</div>
                            </li>
                            <li>
                                <div class="modal-info-item" id="modal-sector">
                                    <strong>Sector:</strong>{{ofertaSeleccionada?.sector_oferta}}
                                </div>
                            </li>
                        </ul>
                    </div>
                </div>

                <h3 style="margin-top: 12px; color: black;">Postulados</h3>
                <small>organizmos a los mejores candidatos por ti</small>

                <ul class="tabs mb-3">
                    <li class="nav-item">
                        <button class="tab-btn" [ngClass]="{ 'active-tab': estadoSeleccionado === 'Pendiente' }"
                            (click)="estadoSeleccionado = 'Pendiente'">
                            Pendientes
                        </button>
                    </li>

                    <li class="nav-item">
                        <button class="tab-btn" [ngClass]="{ 'active-tab': estadoSeleccionado === 'Aceptado' }"
                            (click)="estadoSeleccionado = 'Aceptado'">
                            Aceptados
                        </button>
                    </li>

                    <li class="nav-item">
                        <button class="tab-btn" [ngClass]="{ 'active-tab': estadoSeleccionado === 'Rechazado' }"
                            (click)="estadoSeleccionado = 'Rechazado'">
                            Rechazados
                        </button>
                    </li>
                </ul>
                <div *ngIf="filtrar(estadoSeleccionado).length === 0" class="text-center text-muted my-3">
                    No hay postulados en esta categorÃ­a.
                </div>

                <div class="perfil-card" *ngFor="let p of filtrar(estadoSeleccionado)">
                    <div class="perfil-icono pdf">
                        <i class="fas fa-eye"></i>
                    </div>
                    <div class="perfil-info">
                        <div class="flex-grow-1" style="color: black;">
                            <h6 class="mb-1">{{ p.nombre }} {{ p.apellido }}</h6>
                            Estado:<small [ngClass]="{
                                'text-success': p.estado === 'Aceptado',
                                'text-danger': p.estado === 'Rechazado',
                                'text-secondary': p.estado === 'Pendiente'}">
                            {{ p.estado }}
                            </small>

                        </div>
                        <div>
                            <small class="text-info">
                                {{ p.coincidencias }} de {{ ofertaSeleccionada.habilidades.length }} habilidades
                                coinciden
                            </small>
                        </div>

                        <div style="margin-bottom: 20px;">
                            <div class="preview-chip neutral" *ngFor="let hab of p?.habilidades.split(',')">
                                {{hab.trim() || 'sin competencias' }}
                            </div>
                        </div>
                        <!-- Botones -->
                        <div class="perfil-actions mt-2">
                            <button class="btn btn-outline-secondary btn-sm me-2" (click)="obtenerCVPostulado(p)">
                                <i class="fas fa-eye"></i> Ver CV
                            </button>

                            <button class="btn btn-success btn-sm me-2" (click)="cambiarEstado(p, 'Aceptado')">
                                <i class="fas fa-check-circle"></i> Aceptar
                            </button>

                            <button class="btn btn-outline-danger btn-sm" (click)="cambiarEstado(p, 'Rechazado')">
                                <i class="fas fa-ban"></i> Rechazar
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<div class="pagination">
    <button (click)="cambiarPagina(page - 1)" [disabled]="page === 0">
        Â« Anterior
    </button>

    <span>PÃ¡gina {{ page + 1 }} / {{ totalPages }}</span>

    <button (click)="cambiarPagina(page + 1)" [disabled]="page + 1 >= totalPages">
        Siguiente Â»
    </button>
</div>